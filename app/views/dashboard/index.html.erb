<% content_for :title, "Stashling · Portfolio" %>

<main class="dashboard-shell">
  <header class="dashboard-hero">
    <div class="dashboard-hero__copy">
      <p class="eyebrow">Portfolio Overview</p>
      <h1>Stashling</h1>
      <p>
        Capture every lot, direct each sale, and visualize performance over time.
        This surface will evolve into the interactive canvas described in the spec.
      </p>
    </div>
    <div class="dashboard-hero__actions">
      <button type="button" class="btn btn--primary">Add Lot</button>
      <button type="button" class="btn btn--secondary">Refresh Prices</button>
      <a href="#configuration-panel" class="btn btn--ghost">Configure App</a>
    </div>
  </header>

  <section class="panel panel--stats">
    <h2>Key Metrics</h2>
    <ul class="stat-list">
      <% @summary_stats.each do |stat| %>
        <li class="stat-list__item">
          <p class="stat-list__label"><%= stat[:label] %></p>
          <p class="stat-list__value"><%= stat[:value] %></p>
          <p class="stat-list__hint"><%= stat[:hint] %></p>
        </li>
      <% end %>
    </ul>
  </section>

  <section class="panel panel--accounts" id="account-overview">
    <div class="panel__header">
      <div>
        <h2>Accounts</h2>
        <p class="panel__hint">Filter performance by brokerage or strategy bucket.</p>
      </div>
      <label class="account-filter">
        <span>Account</span>
        <select>
          <% @accounts.each do |account| %>
            <option value="<%= account.id %>"><%= account.name %></option>
          <% end %>
          <% if @accounts.empty? %>
            <option selected>Add an account to begin</option>
          <% end %>
        </select>
      </label>
    </div>
    <div class="account-grid">
      <% @account_glances.each do |acct| %>
        <article class="account-card <%= 'account-card--placeholder' if acct[:placeholder] %>">
          <header>
            <p class="account-card__name"><%= acct[:name] %></p>
            <p class="account-card__institution"><%= acct[:institution] %></p>
          </header>
          <dl>
            <div>
              <dt>Value</dt>
              <dd><%= acct[:value] %></dd>
            </div>
            <div>
              <dt>Cost Basis</dt>
              <dd><%= acct[:cost_basis] %></dd>
            </div>
            <div>
              <dt>Unrealized</dt>
              <dd><%= acct[:unrealized] %></dd>
            </div>
          </dl>
        </article>
      <% end %>
    </div>
  </section>

  <section class="panel panel--grid">
    <h2>Workflows</h2>
    <div class="workflow-grid">
      <% @pipelines.each do |pipe| %>
        <article class="workflow-card">
          <h3><%= pipe[:title] %></h3>
          <p><%= pipe[:description] %></p>
          <button type="button" class="btn btn--ghost"><%= pipe[:cta] %></button>
        </article>
      <% end %>
    </div>
  </section>

  <section class="panel panel--canvas">
    <div class="panel__header">
      <h2>Timeline Preview</h2>
      <p class="panel__hint">Canvas renderer placeholder — wire lots + valuations here.</p>
    </div>
    <div class="canvas-placeholder" data-role="timeline-canvas">
      <span>Canvas rendering surface</span>
    </div>
  </section>

  <section class="panel panel--activity">
    <div class="panel__header">
      <h2>Recent Activity</h2>
      <p class="panel__hint">Once data is flowing, stream audit events into this list.</p>
    </div>
    <ul class="activity-feed">
      <li>• No activity yet — add your first lot to get started.</li>
    </ul>
  </section>

  <section class="panel panel--configuration" id="configuration-panel">
    <div class="panel__header">
      <h2>Configuration</h2>
      <p class="panel__hint">Set up accounts, providers, and global preferences.</p>
    </div>
    <div class="configuration-grid">
      <% @configuration_actions.each do |action| %>
        <article class="configuration-card <%= 'configuration-card--primary' if action[:primary] %>">
          <h3><%= action[:label] %></h3>
          <p><%= action[:description] %></p>
          <button type="button" class="btn btn--secondary">
            <%= action[:primary] ? "Start Setup" : "Open" %>
          </button>
        </article>
      <% end %>
    </div>
  </section>
</main>
